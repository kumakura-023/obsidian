---
created: 2025-12-02T13:17
updated: 2025-12-09T16:02
---
```C#
- using System;
    
- public static class SimpleCalculator
    
- {
    
- public static string Calculate(int o1, int o2, string operation) =>
    
- operation switch
    
- {
    
- "*" => $"{o1} * {o2} = {o1 * o2}",
    
- "+" => $"{o1} + {o2} = {o1 + o2}",
    
- "/" => o2 != 0 ? $"{o1} / {o2} = {o1 / o2}" : "Division by zero is not allowed.",
    
- "" => throw new ArgumentException(),
    
- null => throw new ArgumentNullException(),
    
- _ => throw new ArgumentOutOfRangeException(),
    
- };
    
- }
```

## 外に例外ログを出さない

```C#
public bool WriteSafely(string data)
    {
        try
        {
            database.BeginTransaction();
            database.Write(data);
            database.EndTransaction();
            database.Dispose();
            return true;
        }
        catch(InvalidOperationException)
        {
            database.Dispose();
            return false;
        }
    }
```

## 外に例外を投げる
```C#
public void Write(string data)
    {
        try
        {
            database.BeginTransaction();
            database.Write(data);
            database.EndTransaction();
            database.Dispose();
        }
        catch(Exception)
        {
            database.Dispose();
            throw;
        }
    }
```

## 例外をラップする
```C#
public class CalculationException : Exception
{
	//Excaptionをオーバーライド
    public CalculationException(int operand1, int operand2, string message, Exception inner) : base(message,inner)
    // TODO: complete the definition of the constructor
    {
        Operand1 = operand1;
        Operand2 = operand2;
        
    }

    public int Operand1 { get; }
    public int Operand2 { get; }
}

public class CalculatorTestHarness
{
    private Calculator calculator;

    public CalculatorTestHarness(Calculator calculator)
    {
        this.calculator = calculator;
    }

    public string TestMultiplication(int x, int y)
    {
        try
        {
            Multiply(x, y);
            return "Multiply succeeded";
        }
        catch (CalculationException  ex)
        {
            if (x < 0 && y < 0)
            {
                // innerException が null でない前提でメッセージを使う
                return $"{ex.InnerException.Message}";
            }
            else if(x > 0 && y > 0)
            {
                return $" {ex.InnerException.Message}";
            }
    
            return $"{ex.Operand1} * {ex.Operand2} caused an error.";
        }
    }

    public void Multiply(int x, int y)
    {
        try
        {
            calculator.Multiply(x, y);
        }
        catch (OverflowException ex)
        {
            // Overflow を包み直して CalculationException を投げ直す
            throw new CalculationException(
                x, 
                y, 
                "Overflow during multiplication", 
                ex
            );
        }
    }
}


// Please do not modify the code below.
// If there is an overflow in the multiplication operation
// then a System.OverflowException is thrown.
public class Calculator
{
    public int Multiply(int x, int y)
    {
        checked
        {
            return x * y;
        }
    }
}

```