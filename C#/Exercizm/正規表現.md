---
created: 2025-11-27T09:12
updated: 2025-12-10T15:29
---
```C#
using System.Text.RegularExpressions;
static class LogLine
{
    public static string Message(string logLine)
    { 
        return logLine.Substring(logLine.IndexOf(":") + 1).Trim();
    }

    public static string LogLevel(string logLine)
    {
        string level = logLine.Substring(0,logLine.IndexOf(":")).Trim();
        return level.Replace("[", "").Replace("]", "").ToLower();
    }

    public static string Reformat(string logLine)
    {
        return Message(logLine) + " (" + LogLevel(logLine) + ")";
    }
}

```

```C#
static class LogLine
{
    public static string Message(string logLine)
    {
        int StartIndex = logLine.IndexOf(":") + 1;
        return logLine.Substring(StartIndex).Trim();
    }
    public static string LogLevel(string logLine)
    {
        int StartIndexError = logLine.IndexOf("[");
        int EndIndexErrror = logLine.IndexOf("]");
        string ErrorOnly = logLine.Substring(StartIndexError+1, EndIndexErrror-1).ToLower();
        
        return ErrorOnly;
    }
    public static string Reformat(string logLine)
    {
        string MessageOnly = Message(logLine);
        string ErrorOnly = LogLevel(logLine);
        return $"{MessageOnly} ({ErrorOnly})";
    }
}
```

## 変数を使った文字列

```C#
$"{MessageOnly} ({ErrorOnly})";
```

# Regex

## "password"を検知
```C#
public int CountQuotedPasswords(string lines)
    {
        // パターンの意味:
        // "           : 開きダブルクォート
        // [^"]*       : 次の `"` が出るまでの任意の文字列
        // password    : "password"（大小無視オプションをつける）
        // [^"]*       : またダブルクォート以外の文字
        // "           : 閉じダブルクォート
        var pattern = "\"[^\"\n]*password[^\"\n]*\"";

        var matches = Regex.Matches(
            lines,
            pattern,
            RegexOptions.IgnoreCase
        );

        return matches.Count;
    }
```
## 別解
```C#
Pattern = @""".*password.*""";
Regex.Matches(lines, quotedPasswordRegexPattern, RegexOptions.IgnoreCase).Count;
```

`[^""]*` は正規表現の世界ではこう読むやつだよ。

- `[` `]` … 文字クラス（ここに書かれた文字のどれか1つにマッチする）
    
- `^` … 文字クラスの先頭にあると「否定」になる  
    → **ここに書かれている文字 _以外_ にマッチする**
    
- `""` … C# の verbatim 文字列（@""）では `""` が `"` の1文字になる  
    → 正規表現的には `"（ダブルクォート）`
    

だから  
`[^""]*` ＝ **ダブルクォート以外の任意の文字を 0 回以上**。

## passwordXXXX形式を排除
```C#
public string[] ListLinesWithPasswords(string[] lines)
    {
        // \b          : 単語の境界（password が単語の頭から始まる）
        // password    : 文字列 password （大文字小文字は IgnoreCase で無視）
        // \S+         : そのあとに来る「空白以外の文字」が1文字以上
        var pattern = @"\bpassword\S+";

        var result = new string[lines.Length];

        for (int i = 0; i < lines.Length; i++)
        {
            var line = lines[i];
            var match = Regex.Match(line, pattern, RegexOptions.IgnoreCase);

            if (match.Success)
            {
                // offending password が見つかった場合
                var offendingPassword = match.Value;
                result[i] = $"{offendingPassword}: {line}";
            }
            else
            {
                // password で始まるパスワードが行に存在しない場合
                result[i] = $"--------: {line}";
            }
        }

        return result;
    }
```
## 別解
```C#
public string[] ListLinesWithPasswords(string[] lines) 
{
	 var processedLines = new List<string>();
	 foreach(string line in lines)
	{
	    
		- Match passwordMatch = Regex.Match(line, weakPasswordRegexPattern, RegexOptions.IgnoreCase);
		    
		 if (passwordMatch == Match.Empty)   
			 processedLines.Add($"--------: {line}"); 
		-else
		 processedLines.Add($"{passwordMatch.Value}: {line}");
	}
	 return processedLines.ToArray();
}
```

## ATGC以外を含む
```C#
^[ATGC]+$
```
